<!DOCTYPE html>
<html lang="en">

<head>
  <meta charSet="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Testing Rust Contracts · NEAR Documentation</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="generator" content="Docusaurus" />
  <meta name="description" content="There are a couple of ways to test Rust smart contracts in NEAR." />
  <meta name="docsearch:language" content="en" />
  <meta property="og:title" content="Testing Rust Contracts · NEAR Documentation" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://docs.near.org/" />
  <meta property="og:description" content="There are a couple of ways to test Rust smart contracts in NEAR." />
  <meta property="og:image" content="https://docs.near.org/img/near_logo.svg" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:image" content="https://docs.near.org/img/near_logo.svg" />
  <link rel="shortcut icon" href="/img/favicon.ico" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-dark.min.css" />
  <script>
    (function (i, s, o, g, r, a, m) {
      i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
        (i[r].q = i[r].q || []).push(arguments)
      }, i[r].l = 1 * new Date(); a = s.createElement(o),
        m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
    })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

    ga('create', 'UA-100373569-7', 'auto');
    ga('send', 'pageview');
  </script>
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;900&amp;family=Source+Code+Pro:ital,wght@0,400;0,600;1,400;1,600&amp;display=swap" />
  <link rel="stylesheet" href="/css/copy-code-button.css" />
  <link rel="stylesheet" href="/css/landing-page.css" />
  <link rel="stylesheet" href="https://near.org/wp-content/themes/near-19/assets/dist/near.min.css" />
  <script type="text/javascript" src="https://buttons.github.io/buttons.js"></script>
  <script type="text/javascript"
    src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
  <script type="text/javascript" src="https://use.fontawesome.com/221fd444f5.js"></script>
  <script type="text/javascript" src="/js/copy-code-button.js"></script>
  <script type="text/javascript" src="/js/mixpanel.js"></script>
  <script src="/js/scrollSpy.js"></script>
  <link rel="stylesheet" href="/css/main.css" />
  <script src="/js/codetabs.js"></script>
</head>

<body class="sideNavVisible separateOnPageNav">
  <div class="fixedHeaderContainer">
    <div class="headerWrapper wrapper">
      <header><a href="/"><img class="logo" src="/img/near_logo.svg" alt="NEAR Documentation" /></a>
        <div class="navigationWrapper navigationSlider">
          <nav class="slidingNav">
            <ul class="nav-site nav-site-internal">
              <li class=""><a href="/docs/concepts/new-to-near" target="_self">Concepts</a></li>
              <li class="siteNavGroupActive"><a href="/docs/develop/basics/getting-started" target="_self">Develop</a>
              </li>
              <li class=""><a href="/docs/tools/near-cli" target="_self">Tools</a></li>
              <li class=""><a href="/docs/tutorials/create-transactions" target="_self">Tutorials</a></li>
              <li class=""><a href="/docs/api/rpc" target="_self">API</a></li>
              <li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react"
                  placeholder="Search the Docs..." title="Search the Docs..." /></li>
              <li class=""><a href="/docs/community/community-channels" target="_self">Community</a></li>
              <li class=""><a href="/docs/tokens/token-custody" target="_self">Tokens</a></li>
              <li class=""><a href="/docs/validator/staking-overview" target="_self">Stake</a></li>
              <li class=""><a href="/docs/roles/integrator/exchange-integration" target="_self">Integrate</a></li>
              <li class=""><a href="https://github.com/near/docs/issues" target="_blank">GitHub</a></li>
            </ul>
          </nav>
        </div>
      </header>
    </div>
  </div>
  <div class="navPusher">
    <div class="docMainWrapper wrapper">
      <div class="docsNavContainer" id="docsNav">
        <nav class="toc">
          <div class="toggleNav">
            <section class="navWrapper wrapper">
              <div class="navBreadcrumb wrapper">
                <div class="navToggle" id="navToggler">
                  <div class="hamburger-menu">
                    <div class="line1"></div>
                    <div class="line2"></div>
                    <div class="line3"></div>
                  </div>
                </div>
                <h2><i>›</i><span>Rust</span></h2>
                <div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div>
              </div>
              <div class="navGroups">
                <div class="navGroup">
                  <h3 class="navGroupCategoryTitle">Basics</h3>
                  <ul class="">
                    <li class="navListItem"><a class="navItem" href="/docs/develop/basics/getting-started">Getting
                        Started</a></li>
                    <li class="navListItem"><a class="navItem" href="/docs/develop/basics/create-account">Create
                        Account</a></li>
                    <li class="navListItem"><a class="navItem"
                        href="/docs/develop/basics/hackathon-startup-guide">Hackathon Guide</a></li>
                  </ul>
                </div>
                <div class="navGroup">
                  <h3 class="navGroupCategoryTitle">Front-end</h3>
                  <ul class="">
                    <li class="navListItem"><a class="navItem"
                        href="/docs/develop/front-end/introduction">Introduction</a></li>
                    <li class="navListItem"><a class="navItem" href="/docs/develop/front-end/near-api-js">API JS
                        Library</a></li>
                  </ul>
                </div>
                <div class="navGroup">
                  <h3 class="navGroupCategoryTitle">Smart Contracts</h3>
                  <ul class="">
                    <li class="navListItem"><a class="navItem" href="/docs/develop/contracts/overview">Overview</a></li>
                    <div class="navGroup subNavGroup">
                      <h4 class="navGroupSubcategoryTitle">AssemblyScript</h4>
                      <ul>
                        <li class="navListItem"><a class="navItem"
                            href="/docs/develop/contracts/as/intro">Introduction</a></li>
                        <li class="navListItem"><a class="navItem" href="/docs/develop/contracts/as/near-sdk-as">AS
                            SDK</a></li>
                        <li class="navListItem"><a class="navItem"
                            href="/docs/develop/contracts/as/testing-as-contracts">Testing</a></li>
                      </ul>
                    </div>
                    <div class="navGroup subNavGroup">
                      <h4 class="navGroupSubcategoryTitle">Rust</h4>
                      <ul>
                        <li class="navListItem"><a class="navItem"
                            href="/docs/develop/contracts/rust/intro">Introduction</a></li>
                        <li class="navListItem"><a class="navItem" href="/docs/develop/contracts/rust/near-sdk-rs">Rust
                            SDK</a></li>
                        <li class="navListItem navListItemActive"><a class="navItem"
                            href="/docs/develop/contracts/rust/testing-rust-contracts">Testing</a></li>
                      </ul>
                    </div>
                  </ul>
                </div>
                <div class="navGroup">
                  <h3 class="navGroupCategoryTitle">Running A Node</h3>
                  <ul class="">
                    <li class="navListItem"><a class="navItem" href="/docs/develop/node/running-a-node">Running a
                        node</a></li>
                    <li class="navListItem"><a class="navItem" href="/docs/develop/node/running-a-node-windows">Running
                        a node (Windows)</a></li>
                  </ul>
                </div>
                <div class="navGroup">
                  <h3 class="navGroupCategoryTitle">Aurora Engine</h3>
                  <ul class="">
                    <div class="navGroup subNavGroup">
                      <h4 class="navGroupSubcategoryTitle">EVM on NEAR</h4>
                      <ul>
                        <li class="navListItem"><a class="navItem"
                            href="/docs/develop/evm/introduction">Introduction</a></li>
                        <li class="navListItem"><a class="navItem" href="/docs/develop/evm/evm-network-status">Network
                            Status</a></li>
                        <li class="navListItem"><a class="navItem" href="/docs/develop/evm/truffle">Truffle</a></li>
                        <li class="navListItem"><a class="navItem" href="/docs/develop/evm/near-eth-rpc">Proxy RPC
                            Server</a></li>
                        <li class="navListItem"><a class="navItem" href="/docs/develop/evm/near-web3-provider">Web3
                            Provider</a></li>
                        <li class="navListItem"><a class="navItem" href="/docs/develop/evm/evm-testing">Testing
                            Contracts</a></li>
                      </ul>
                    </div>
                  </ul>
                </div>
              </div>
            </section>
          </div>
          <script />
          var coll = document.getElementsByClassName('collapsible');
          var checkActiveCategory = true;
          for (var i = 0; i < coll.length; i++) { var links=coll[i].nextElementSibling.getElementsByTagName('*'); if
            (checkActiveCategory){ for (var j=0; j < links.length; j++) { if
            (links[j].classList.contains('navListItemActive')){ coll[i].nextElementSibling.classList.toggle('hide');
            coll[i].childNodes[1].classList.toggle('rotate'); checkActiveCategory=false; break; } } }
            coll[i].addEventListener('click', function() { var arrow=this.childNodes[1];
            arrow.classList.toggle('rotate'); var content=this.nextElementSibling; content.classList.toggle('hide'); });
            } document.addEventListener('DOMContentLoaded', function() { createToggler('#navToggler', '#docsNav'
            , 'docsSliderActive' ); createToggler('#tocToggler', 'body' , 'tocActive' ); var
            headings=document.querySelector('.toc-headings'); headings && headings.addEventListener('click',
            function(event) { var el=event.target; while(el !==headings){ if (el.tagName==='A' ) {
            document.body.classList.remove('tocActive'); break; } else{ el=el.parentNode; } } }, false); function
            createToggler(togglerSelector, targetSelector, className) { var
            toggler=document.querySelector(togglerSelector); var target=document.querySelector(targetSelector); if
            (!toggler) { return; } toggler.onclick=function(event) { event.preventDefault();
            target.classList.toggle(className); }; } }); </script>
        </nav>
      </div>
      <div class="container mainContainer docsContainer">
        <div class="wrapper">
          <div class="post">
            <header class="postHeader"><a class="edit-page-link button"
                href="https://github.com/near/docs/tree/master/docs/develop/contracts/rust/testing.md" target="_blank"
                rel="noreferrer noopener">Edit</a>
              <h1 id="__docusaurus" class="postHeaderTitle">Testing Rust Contracts</h1>
            </header>
            <article>
              <div><span>
                  <p>There are a couple of ways to test Rust smart contracts in NEAR.</p>
                  <ul>
                    <li><a href="#unit-tests">Unit tests</a></li>
                    <li><a href="#simulation-tests">Simulation tests</a></li>
                    <li><a href="#end-to-end-tests">End-to-end tests</a></li>
                  </ul>
                  <p>This document will cover the first two in detail, and link to various code examples to refer to.
                    Keep in mind that there are some simple examples located at <a href="https://near.dev"
                      target="_blank">our examples page</a> that implement these tests.</p>
                  <h2><a class="anchor" aria-hidden="true" id="unit-tests"></a><a href="#unit-tests" aria-hidden="true"
                      class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1"
                        viewBox="0 0 16 16" width="16">
                        <path fill-rule="evenodd"
                          d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z">
                        </path>
                      </svg></a>Unit tests</h2>
                  <p><a href="https://en.wikipedia.org/wiki/Unit_testing" target="_blank">Unit tests</a> in Rust are
                    quite an important part of the development lifecycle of smart contracts. Yes, they test individual
                    parts of the source code to verify expected behavior, but they're also part of the iteration
                    process.</p>
                  <p>Let's take a step back for a moment. Perhaps a developer has gone through the (amazing) <a
                      href="https://doc.rust-lang.org/stable/book/" target="_blank">online Rust book</a> already. In the
                    first chapter it introduces the command:</p>
                  <pre><code class="hljs">cargo run
</code></pre>
                  <p>In the context of the Hello World app of that chapter, this makes sense. <code>cargo run</code>
                    will hit the entry point <code>fn main()</code> and print &quot;Hello, world!&quot;</p>
                  <p>However, when writing smart contracts there is no entry point like this. In this sense, writing a
                    smart contract in Rust is more similar to <a
                      href="https://wasmbyexample.dev/examples/hello-world/hello-world.rust.en-us.html"
                      target="_blank">writing a Javascript WebAssembly app</a>, where the primary Rust file is
                    considered a library and is stored in <code>src/lib.rs</code> instead of <code>src/main.rs</code>
                    like the book's Hello World example.</p>
                  <p>In the absence of <code>cargo run</code> and the entry point, unit tests may become the primary way
                    to quickly check that your code is behaving properly. And while there is no <code>println!()</code>
                    on the blockchain, the tests can freely use it for debugging purposes if desired.</p>
                  <p>This slide demonstrates a possible approach to a newcomer to Rust and smart contracts:</p>
                  <p><img src="/img/rust-testing-iterate.png"
                      alt="Take an example, modify it, write tests, fix errors, iterate"></p />
                  <p>Let's take a look at a sample of code that may appear in a simple Rust smart contract. (This code
                    is taken from the <a
                      href="https://github.com/near-examples/NFT/blob/4c55057523b2c5370fa3f23101e89927c35e0c18/contracts/rust/src/lib.rs#L179-L243"
                      target="_blank">non-fungible token contract</a>.)</p>
                  <p>If all the code to the contract is contained in one file (<code>src/lib.rs</code>) this is
                    typically found at the bottom of the file.
                    Below is somewhat boilerplate code that sets up the <code>VMContext</code> for a mock blockchain:
                  </p>
                  <pre><code class="hljs css language-rust"><span class="hljs-meta">#[cfg(test)]</span>
<span class="hljs-keyword">mod</span> tests {
    <span class="hljs-keyword">use</span> super::*;
    <span class="hljs-keyword">use</span> near_sdk::MockedBlockchain;
    <span class="hljs-keyword">use</span> near_sdk::{testing_env, VMContext};
    …
    <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">get_context</span></span>(predecessor_account_id: <span class="hljs-built_in">String</span>, storage_usage: <span class="hljs-built_in">u64</span>) -&gt; VMContext {
        VMContext {
            current_account_id: <span class="hljs-string">"alice.testnet"</span>.to_string(),
            signer_account_id: <span class="hljs-string">"jane.testnet"</span>.to_string(),
            signer_account_pk: <span class="hljs-built_in">vec!</span>[<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>],
            predecessor_account_id,
            input: <span class="hljs-built_in">vec!</span>[],
            block_index: <span class="hljs-number">0</span>,
            block_timestamp: <span class="hljs-number">0</span>,
            account_balance: <span class="hljs-number">0</span>,
            account_locked_balance: <span class="hljs-number">0</span>,
            storage_usage,
            attached_deposit: <span class="hljs-number">0</span>,
            prepaid_gas: <span class="hljs-number">10u64</span>.pow(<span class="hljs-number">18</span>),
            random_seed: <span class="hljs-built_in">vec!</span>[<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>],
            is_view: <span class="hljs-literal">false</span>,
            output_data_receivers: <span class="hljs-built_in">vec!</span>[],
            epoch_height: <span class="hljs-number">19</span>,
        }
    }

    <span class="hljs-comment">// Tests</span>
}
</code></pre>
                  <p>The important thing to remember is <code>VMContext</code> will be sending mock transactions with
                    the context specified above. So if a unit test needs to send a test transaction coming from Alice,
                    and then another from Bob, the <code>get_context</code> method may be called to change the
                    <code>signer_account_id</code> or <code>predecessor_account_id</code>, or whatever the contract
                    needs.
                  </p>
                  <p>Following the <code>get_context</code> function are any number of tests. These use the
                    <code>#[test]</code> macro above test functions. Unlike other testing frameworks, the function name
                    can be anything and doesn't have to fit a pattern or naming convention.
                    In the above code block, there is a comment <code>// Tests</code> that will contain test code like
                    this:
                  </p>
                  <pre><code class="hljs css language-rust"><span class="hljs-meta">#[test]</span>
<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">grant_access</span></span>() {
    <span class="hljs-keyword">let</span> context = get_context(robert(), <span class="hljs-number">0</span>);                     ⟵ get our VMContext from earlier
    testing_env!(context);                                      ⟵ set the testing environment
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> contract = NonFungibleTokenBasic::new(robert());    ⟵ instantiate custom <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">for</span></span> this contract
    <span class="hljs-keyword">let</span> length_before = contract.account_gives_access.len();    ⟵ <span class="hljs-keyword">use</span> dot notation to access (public) member variables
    <span class="hljs-built_in">assert_eq!</span>(<span class="hljs-number">0</span>, length_before, <span class="hljs-string">"Expected empty access."</span>);     ⟵ make an assertion, <span class="hljs-keyword">if</span> it fails, provide custom message
    contract.grant_access(mike());                              ⟵ <span class="hljs-keyword">use</span> dot notation to call (public) methods
    contract.grant_access(joe());
    <span class="hljs-keyword">let</span> length_after = contract.account_gives_access.len();
    <span class="hljs-built_in">assert_eq!</span>(<span class="hljs-number">1</span>, length_after, <span class="hljs-string">"Expected an entry in the account's access Map."</span>);
    <span class="hljs-keyword">let</span> predecessor_hash = env::sha256(robert().as_bytes());
    <span class="hljs-keyword">let</span> num_grantees = contract.account_gives_access.get(&amp;predecessor_hash).unwrap();
    <span class="hljs-built_in">assert_eq!</span>(<span class="hljs-number">2</span>, num_grantees.len(), <span class="hljs-string">"Expected two accounts to have access to predecessor."</span>);
}
</code></pre>
                  <p>Look for the <code>⟵</code> in the above code snippet to understand a typical pattern of writing
                    unit tests. This will be quite different in simulation tests, which will be covered later in this
                    document. In summary the pattern could be boiled down to:</p>
                  <ol>
                    <li>Set up VMContext and testing environment</li>
                    <li>Instantiate the primary struct of the smart contract</li>
                    <li>Use dot notation to call methods and access member variables</li>
                    <li>Use assertions to ensure proper behavior</li>
                  </ol>
                  <p>Let's add another test, but this time one that's expected to fail.</p>
                  <pre><code class="hljs css language-rust"><span class="hljs-meta">#[test]</span>
<span class="hljs-meta">#[should_panic(
    expected = r#<span class="hljs-meta-string">"Access does not exist."</span>#
)]</span>
<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">revoke_access_and_panic</span></span>() {
    <span class="hljs-keyword">let</span> context = get_context(robert(), <span class="hljs-number">0</span>);
    testing_env!(context);
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> contract = NonFungibleTokenBasic::new(robert());
    contract.revoke_access(joe());
}
</code></pre>
                  <p><strong>Note</strong>: each unit test is indepedent of the test before it. If the previous tested
                    added values to a Map, they will not persist on subsequent tests.</p>
                  <p>To run unit tests, simply run this command in the proper directory, typically containing your
                    <code>Cargo.toml</code> file.
                  </p>
                  <pre><code class="hljs">cargo test -- --nocapture
</code></pre>
                  <p>The <code>--nocapture</code> flag will make sure that output from assertions and macros like
                    <code>println!()</code> will be show in your terminal / command prompt. If you'd like to customize
                    or limit which tests run, please see <a
                      href="https://doc.rust-lang.org/cargo/commands/cargo-test.html" target="_blank">the documentation
                      here</a>.
                  </p>
                  <p>In summary, unit tests are a great way to make sure that the methods and data structures in your
                    smart contract are working as intended.</p>
                  <h2><a class="anchor" aria-hidden="true" id="simulation-tests"></a><a href="#simulation-tests"
                      aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16"
                        version="1.1" viewBox="0 0 16 16" width="16">
                        <path fill-rule="evenodd"
                          d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z">
                        </path>
                      </svg></a>Simulation tests</h2>
                  <p>Within <a href="https://github.com/near/near-sdk-rs"><code>near-sdk-rs</code></a> there is a
                    library <a
                      href="https://github.com/near/near-sdk-rs/tree/master/near-sdk-sim"><code>near-sdk-sim</code></a>
                    that allows simulation testing for Rust smart contracts. With this utility you can:</p>
                  <ul>
                    <li>Test cross-contract calls</li>
                    <li>Profile gas &amp; storage usage for your contract</li>
                    <li>Inspect intermediate state of all calls within complex transactions</li>
                  </ul>
                  <p>For a step-by-step guide and more information, see the <a
                      href="https://github.com/near/near-sdk-rs/tree/master/near-sdk-sim">README</a> file for
                    <code>near-sdk-sim</code>.
                  </p>
                  <h2><a class="anchor" aria-hidden="true" id="end-to-end-tests"></a><a href="#end-to-end-tests"
                      aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16"
                        version="1.1" viewBox="0 0 16 16" width="16">
                        <path fill-rule="evenodd"
                          d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z">
                        </path>
                      </svg></a>End-to-end tests</h2>
                  <p>This is where the rubber meets the road. End-to-end tests will help determine if the application is
                    behaving as expected allowing us to see the entire flow of an app from start to finish. Unlike the
                    previously mentioned tests, here we will use a live network (i.e. &quot;testnet&quot;) (with actual
                    tokens) to view (in real time) how our code behaves and any problems we may encounter. There many
                    are testing applications that can accomplish this, but for our purposes we will focus on the <a
                      href="https://jestjs.io/">Jest testing suite</a>.</p>
                  <p>Jest is a JavaScript testing framework that allows us to write and execute tests by writing simple
                    JS functions. These tests have the following basic structure:</p>
                  <pre><code class="hljs css language-js"><span class="hljs-keyword">import</span> { add } <span class="hljs-keyword">from</span> <span class="hljs-string">'./utils'</span>

    it(<span class="hljs-string">'should add 1 &amp; 5'</span>, () =&gt; {
        <span class="hljs-keyword">const</span> addResult = add(<span class="hljs-number">1</span>, <span class="hljs-number">5</span>)
        expect(addResult).toEqual(<span class="hljs-number">6</span>);
    })
</code></pre>
                  <p>As you can see there are two main components.</p>
                  <ul>
                    <li>import resources that we want to test or will need to compose a test</li>
                    <li>compose a test and define what we expect the results to be</li>
                  </ul>
                  <p><strong>Note</strong>: For more information on getting started, be sure to check out the <a
                      href="https://jestjs.io/docs/en/getting-started">Jest Docs</a>.</p>
                  <p>If you are starting a new project using <a
                      href="https://github.com/near/create-near-app">create-near-app</a> Jest will be automatically
                    installed as a development dependency and will be configured to run end-to-end tests. If you explore
                    the <code>package.json</code> file you will see that the <code>&quot;testEnvironment&quot;</code>
                    for Jest is set to <code>&quot;near-cli/test_environment&quot;</code>. In addition to this, there is
                    a file <code>test.near.json</code> in the <code>neardev/shared-test</code> directory. This file
                    contains an <code>account_id</code> as well as a <code>private_key</code> that is required for
                    performing these tests.</p>
                  <p>Lets take a look at an example of end-to-end tests from the <a
                      href="https://examples.near.org/guest-book">NEAR Guest-Book</a> example. Here we have included two
                    additional features to our tests.</p>
                  <ol>
                    <li>declaring mutable variables before a test that all subsequent tests have access to</li>
                    <li>integrating the <code>beforeAll</code> function that will perform a series of routines before
                      each and every test</li>
                  </ol>
                  <pre><code class="hljs css language-js"><span class="hljs-keyword">import</span> <span class="hljs-string">'regenerator-runtime/runtime'</span>

<span class="hljs-keyword">let</span> near
<span class="hljs-keyword">let</span> contract
<span class="hljs-keyword">let</span> accountId

beforeAll(<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  near = <span class="hljs-keyword">await</span> nearlib.connect(nearConfig)
  accountId = nearConfig.contractName
  contract = <span class="hljs-keyword">await</span> near.loadContract(nearConfig.contractName, {
    <span class="hljs-attr">viewMethods</span>: [<span class="hljs-string">'getMessages'</span>],
    <span class="hljs-attr">changeMethods</span>: [<span class="hljs-string">'addMessage'</span>],
    <span class="hljs-attr">sender</span>: accountId
  })
})

it(<span class="hljs-string">'send one message and retrieve it'</span>, <span class="hljs-keyword">async</span> () =&gt; {
  <span class="hljs-keyword">await</span> contract.addMessage({ <span class="hljs-attr">text</span>: <span class="hljs-string">'aloha'</span> })
  <span class="hljs-keyword">const</span> msgs = <span class="hljs-keyword">await</span> contract.getMessages()
  <span class="hljs-keyword">const</span> expectedMessagesResult = [{
    <span class="hljs-attr">premium</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">sender</span>: accountId,
    <span class="hljs-attr">text</span>: <span class="hljs-string">'aloha'</span>
  }]
  expect(msgs).toEqual(expectedMessagesResult)
})

it(<span class="hljs-string">'send two more messages and expect three total'</span>, <span class="hljs-keyword">async</span> () =&gt; {
  <span class="hljs-keyword">await</span> contract.addMessage({ <span class="hljs-attr">text</span>: <span class="hljs-string">'foo'</span> })
  <span class="hljs-keyword">await</span> contract.addMessage({ <span class="hljs-attr">text</span>: <span class="hljs-string">'bar'</span> })
  <span class="hljs-keyword">const</span> msgs = <span class="hljs-keyword">await</span> contract.getMessages()
  expect(msgs.length).toEqual(<span class="hljs-number">3</span>)
})
</code></pre>
                  <p>These are two examples of complete end-to-end tests that:</p>
                  <ol>
                    <li>connect to a live NEAR blockchain network</li>
                  </ol>
                  <pre><code class="hljs css language-js">near = <span class="hljs-keyword">await</span> nearlib.connect(nearConfig)
</code></pre>
                  <ol start="2">
                    <li>load a specific contract with the associated view and change methods</li>
                  </ol>
                  <pre><code class="hljs css language-js">contract = <span class="hljs-keyword">await</span> near.loadContract(nearConfig.contractName, {
  <span class="hljs-attr">viewMethods</span>: [<span class="hljs-string">'getMessages'</span>],
  <span class="hljs-attr">changeMethods</span>: [<span class="hljs-string">'addMessage'</span>],
  <span class="hljs-attr">sender</span>: accountId
})
</code></pre>
                  <ol start="3">
                    <li>call a method / function written in said contract</li>
                  </ol>
                  <pre><code class="hljs css language-js"> <span class="hljs-keyword">await</span> contract.addMessage({ <span class="hljs-attr">text</span>: <span class="hljs-string">'aloha'</span> })
</code></pre>
                  <ol start="4">
                    <li>request the results of our action</li>
                  </ol>
                  <pre><code class="hljs css language-js"><span class="hljs-keyword">const</span> msgs = <span class="hljs-keyword">await</span> contract.getMessages()
</code></pre>
                  <p>These Jest integration tests can be run on both AssemblyScript and Rust contracts.</p>
                  <blockquote>
                    <p>Got a question?
                      <a href="https://stackoverflow.com/questions/tagged/nearprotocol">
                        <h8>Ask it on StackOverflow!</h8>
                      </a>
                    </p>
                  </blockquote>
                </span></div>
            </article>
          </div>
          <div class="docLastUpdate"><em>Last updated on 1/15/2021 by Mike Purvis</em></div>
          <div class="docs-prevnext"><a class="docs-prev button" href="/docs/develop/contracts/rust/near-sdk-rs"><span
                class="arrow-prev">← </span><span>Rust SDK</span></a><a class="docs-next button"
              href="/docs/develop/node/running-a-node"><span>Running a node</span><span class="arrow-next"> →</span></a>
          </div>
        </div>
      </div>
      <nav class="onPageNav">
        <ul class="toc-headings">
          <li><a href="#unit-tests">Unit tests</a></li>
          <li><a href="#simulation-tests">Simulation tests</a></li>
          <li><a href="#end-to-end-tests">End-to-end tests</a></li>
        </ul>
      </nav>
    </div>
    <footer class="relative pt-100 pb-40 md:pb-100 bg-black text-white mt-150">
      <div class="absolute pin-t pin-r" style="max-width:50vw"><img
          src="https://near.org/wp-content/themes/near-19/assets/img/neue/distortion-footer.svg?t=1600963469"
          class="locked" style="transform:translateY(-60%)" alt="" /></div>
      <div class="container">
        <div class="row">
          <div class="col md:w-1/4"><img
              src="https://near.org/wp-content/themes/near-19/assets/img/neue/logomark-white.svg?t=1600963474"
              class="locked" width="91" alt="" />
            <ul class="list-reset text-24 font-black text-yellow mt-50">
              <li><a href="https://wallet.testnet.near.org/" class="hover:text-white">Wallet</a></li>
              <li><a href="https://explorer.near.org/" class="hover:text-white">Explorer</a></li>
              <li><a href="https://near.dev/" class="hover:text-white">Examples</a></li>
            </ul>
          </div>
          <div class="col md:w-3/4 mt-50 md:mt-0">
            <ul class="list-reset flex flex-wrap -mx-20">
              <li class="mx-20"><a href="https://gov.near.org" class="block hover:text-discourse" target="_blank"
                  id="discourse-1"><span class="icon icon-36"><svg enable-background="new 0 0 34 35" viewBox="0 0 34 35"
                      xmlns="http://www.w3.org/2000/svg">
                      <path
                        d="m0 25.1c0-2.6 0-5.2 0-7.8 0-4.7 1.8-8.8 5.2-12.1 2.6-2.5 5.8-4 9.4-4.5 6.9-1.1 13.7 2.3 17.2 8.4 1.6 3 2.4 6.2 2.2 9.5-.4 4.6-2.3 8.5-5.7 11.6-2.5 2.2-5.4 3.6-8.6 4.1-.6.1-1.3.2-2 .2-5.7 0-11.4 0-17.1 0-.4 0-.5-.1-.5-.5-.1-3-.1-6-.1-8.9zm16.9-17.3c-.6 0-1.2.1-1.8.2-6.2 1.3-9.6 8.1-6.7 13.7.1.3.1.5.1.7-.5 1.6-1 3.2-1.4 4.7-.1.1-.1.3-.1.4.1.1.3 0 .4-.1 1.7-.4 3.4-.9 5.1-1.3.3-.1.6-.1.9.1 1.6.7 3.4.9 5.1.6 5.2-.8 8.9-5.7 8.1-11-.8-4.5-4.8-8-9.7-8z">
                      </path>
                    </svg></span><span class="screen-reader-text">Forum</span></a></li>
              <li class="mx-20"><a href="https://twitter.com/nearprotocol" class="block hover:text-twitter"
                  target="_blank"><span class="icon icon-36 "><svg xmlns="http://www.w3.org/2000/svg"
                      viewBox="0 0 512 512">
                      <path
                        d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z">
                      </path>
                    </svg></span><span class="screen-reader-text">Twitter</span></a></li>
              <li class="mx-20"><a href="https://github.com/near" class="block hover:text-github" target="_blank"><span
                    class="icon icon-36 "><svg height="36" viewBox="0 0 36 36" width="36"
                      xmlns="http://www.w3.org/2000/svg">
                      <path
                        d="m17.9991429 0c-9.93942861 0-17.9991429 8.058-17.9991429 18.0008571 0 7.9517143 5.15742857 14.6982858 12.3102857 17.0794286.9.1645714 1.2291429-.3908571 1.2291429-.8682857 0-.4268571-.0162857-1.5591429-.0248572-3.0608571-5.0065714 1.0868571-6.06342854-2.4137143-6.06342854-2.4137143-.81857143-2.0785715-1.99885715-2.6322857-1.99885715-2.6322857-1.63371428-1.1177143.12428572-1.0937143.12428572-1.0937143 1.806.1268571 2.75742857 1.8548571 2.75742857 1.8548571 1.60542857 2.7505714 4.2128571 1.956 5.238 1.4948572.1628571-1.1631429.6282857-1.956 1.1425714-2.406-3.9968571-.4542858-8.1985714-1.9988572-8.1985714-8.8962858 0-1.9654285.70114286-3.5717142 1.85228571-4.83-.18514285-.456-.80314285-2.28514281.17657143-4.76399996 0 0 1.51114286-.48342857 4.94999996 1.84542857 1.4357143-.39942857 2.9751429-.59914285 4.506-.606 1.5282858.00685715 3.0685715.20657143 4.5068572.606 3.4362857-2.32885714 4.944-1.84542857 4.944-1.84542857.9831428 2.47885715.3651428 4.30799996.1791428 4.76399996 1.1545715 1.2582858 1.8505715 2.8645715 1.8505715 4.83 0 6.9154286-4.2085715 8.436-8.2182857 8.8825715.6462857.5554285 1.2214285 1.6534285 1.2214285 3.3325714 0 2.4068571-.0214285 4.3482857-.0214285 4.938 0 .4817143.324 1.0414286 1.2377142.8657143 7.146-2.3845714 12.2991429-9.1277143 12.2991429-17.0768572 0-9.9428571-8.0597143-18.0008571-18.0008571-18.0008571">
                      </path>
                    </svg></span><span class="screen-reader-text">GitHub</span></a></li>
              <li class="mx-20"><a href="http://near.chat" class="block hover:text-discord" target="_blank"><span
                    class="icon icon-36 "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
                      <path
                        d="M297.216 243.2c0 15.616-11.52 28.416-26.112 28.416-14.336 0-26.112-12.8-26.112-28.416s11.52-28.416 26.112-28.416c14.592 0 26.112 12.8 26.112 28.416zm-119.552-28.416c-14.592 0-26.112 12.8-26.112 28.416s11.776 28.416 26.112 28.416c14.592 0 26.112-12.8 26.112-28.416.256-15.616-11.52-28.416-26.112-28.416zM448 52.736V512c-64.494-56.994-43.868-38.128-118.784-107.776l13.568 47.36H52.48C23.552 451.584 0 428.032 0 398.848V52.736C0 23.552 23.552 0 52.48 0h343.04C424.448 0 448 23.552 448 52.736zm-72.96 242.688c0-82.432-36.864-149.248-36.864-149.248-36.864-27.648-71.936-26.88-71.936-26.88l-3.584 4.096c43.52 13.312 63.744 32.512 63.744 32.512-60.811-33.329-132.244-33.335-191.232-7.424-9.472 4.352-15.104 7.424-15.104 7.424s21.248-20.224 67.328-33.536l-2.56-3.072s-35.072-.768-71.936 26.88c0 0-36.864 66.816-36.864 149.248 0 0 21.504 37.12 78.08 38.912 0 0 9.472-11.52 17.152-21.248-32.512-9.728-44.8-30.208-44.8-30.208 3.766 2.636 9.976 6.053 10.496 6.4 43.21 24.198 104.588 32.126 159.744 8.96 8.96-3.328 18.944-8.192 29.44-15.104 0 0-12.8 20.992-46.336 30.464 7.68 9.728 16.896 20.736 16.896 20.736 56.576-1.792 78.336-38.912 78.336-38.912z">
                      </path>
                    </svg></span><span class="screen-reader-text">Discord</span></a></li>
              <li class="mx-20"><a href="https://t.me/cryptonear" class="block hover:text-telegram"
                  target="_blank"><span class="icon icon-36 "><svg xmlns="http://www.w3.org/2000/svg"
                      viewBox="0 0 496 512">
                      <path
                        d="M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm121.8 169.9l-40.7 191.8c-3 13.6-11.1 16.9-22.4 10.5l-62-45.7-29.9 28.8c-3.3 3.3-6.1 6.1-12.5 6.1l4.4-63.1 114.9-103.8c5-4.4-1.1-6.9-7.7-2.5l-142 89.4-61.2-19.1c-13.3-4.2-13.6-13.3 2.8-19.7l239.1-92.2c11.1-4 20.8 2.7 17.2 19.5z">
                      </path>
                    </svg></span><span class="screen-reader-text">Telegram</span></a></li>
              <li class="mx-20"><a href="https://near.org/wechat" class="block hover:text-wechat" target="_blank"><span
                    class="icon icon-36 "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512">
                      <path
                        d="M385.2 167.6c6.4 0 12.6.3 18.8 1.1C387.4 90.3 303.3 32 207.7 32 100.5 32 13 104.8 13 197.4c0 53.4 29.3 97.5 77.9 131.6l-19.3 58.6 68-34.1c24.4 4.8 43.8 9.7 68.2 9.7 6.2 0 12.1-.3 18.3-.8-4-12.9-6.2-26.6-6.2-40.8-.1-84.9 72.9-154 165.3-154zm-104.5-52.9c14.5 0 24.2 9.7 24.2 24.4 0 14.5-9.7 24.2-24.2 24.2-14.8 0-29.3-9.7-29.3-24.2.1-14.7 14.6-24.4 29.3-24.4zm-136.4 48.6c-14.5 0-29.3-9.7-29.3-24.2 0-14.8 14.8-24.4 29.3-24.4 14.8 0 24.4 9.7 24.4 24.4 0 14.6-9.6 24.2-24.4 24.2zM563 319.4c0-77.9-77.9-141.3-165.4-141.3-92.7 0-165.4 63.4-165.4 141.3S305 460.7 397.6 460.7c19.3 0 38.9-5.1 58.6-9.9l53.4 29.3-14.8-48.6C534 402.1 563 363.2 563 319.4zm-219.1-24.5c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.8 0 24.4 9.7 24.4 19.3 0 10-9.7 19.6-24.4 19.6zm107.1 0c-9.7 0-19.3-9.7-19.3-19.6 0-9.7 9.7-19.3 19.3-19.3 14.5 0 24.4 9.7 24.4 19.3.1 10-9.9 19.6-24.4 19.6z">
                      </path>
                    </svg></span><span class="screen-reader-text">WeChat</span></a></li>
              <li class="mx-20"><a href="https://www.youtube.com/channel/UCuKdIYVN8iE3fv8alyk1aMw"
                  class="block hover:text-youtube" target="_blank"><span class="icon icon-36 "><svg
                      xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512">
                      <path
                        d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z">
                      </path>
                    </svg></span><span class="screen-reader-text">YouTube</span></a></li>
            </ul>
            <div class="row">
              <div class="col sm:w-1/3 mt-50">
                <h2 class="text-24 font-black text-blue-light">Developers</h2>
                <ul id="menu-developers-1" class="footer-menu list-reset mt-5 text-16 md:text-18">
                  <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-550"><a
                      href="https://near.org/developers/">Overview</a></li>
                  <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2801"><a
                      href="https://near.org/technology/">Technology</a></li>
                  <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-116"><a target="_blank"
                      rel="noopener noreferrer" href="https://github.com/near" id="github">GitHub</a></li>
                  <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4720"><a
                      href="https://near.org/bounties/">Bounties</a></li>
                  <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-580"><a
                      href="https://near.org/grants/">Grants</a></li>
                </ul>
              </div>
              <div class="col sm:w-1/3 mt-50">
                <h2 class="text-24 font-black text-blue-light">Community</h2>
                <ul id="menu-community-1" class="footer-menu list-reset mt-5 text-16 md:text-18">
                  <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6804"><a
                      href="https://gov.near.org/">Forum</a></li>
                  <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4650"><a
                      href="https://near.org/events">Events</a></li>
                  <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2045"><a
                      href="https://near.org/contributor/">Contributor Program</a></li>
                  <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4157"><a
                      href="https://near.org/guilds/">Guild Program</a></li>
                  <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-2945" />
                  document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                  return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                  const search = document.getElementById('search_input_react');
                  search && search.focus();
                  }
                  });
                  </script>
                  <script>
                    var search = docsearch({

                      apiKey: '058929d1d423f0f46d3278a102d58bfd',
                      indexName: 'near',
                      inputSelector: '#search_input_react'
                    });
                  </script>
</body>

</html>
